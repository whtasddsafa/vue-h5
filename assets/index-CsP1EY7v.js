import{as as ee,d as U,B as te,a2 as S,A as q,C as D,r as d,at as ne,p as K,w as j,au as oe,f as G,ag as J,an as ie,e as h,O as Q,av as I,aw as se,U as X,ax as Z,ay as ae,az as le,W as ce,o as z,q as de,a as b,c as O,F as re,ad as ue,b as $,t as fe,k as xe}from"./index-BS8FVB4C.js";import{L as me}from"./index-BVU_NsVF.js";import{b as W}from"./route-block-B_A1xBdJ.js";const ve=Symbol(),he=()=>ee(ve,null),[ge,L,Te]=D("list"),_e={error:Boolean,offset:q(300),loading:Boolean,disabled:Boolean,finished:Boolean,scroller:Object,errorText:String,direction:S("down"),loadingText:String,finishedText:String,immediateCheck:te};var ye=U({name:ge,props:_e,emits:["load","update:error","update:loading"],setup(e,{emit:u,slots:o}){const s=d(e.loading),r=d(),g=d(),a=he(),T=ne(r),_=K(()=>e.scroller||T.value),f=()=>{Q(()=>{if(s.value||e.finished||e.disabled||e.error||(a==null?void 0:a.value)===!1)return;const{direction:i}=e,k=+e.offset,w=I(_);if(!w.height||se(r))return;let t=!1;const n=I(g);i==="up"?t=w.top-n.top<=k:t=n.bottom-w.bottom<=k,t&&(s.value=!0,u("update:loading",!0),u("load"))})},x=()=>{if(e.finished){const i=o.finished?o.finished():e.finishedText;if(i)return h("div",{class:L("finished-text")},[i])}},M=()=>{u("update:error",!1),f()},N=()=>{if(e.error){const i=o.error?o.error():e.errorText;if(i)return h("div",{role:"button",class:L("error-text"),tabindex:0,onClick:M},[i])}},E=()=>{if(s.value&&!e.finished&&!e.disabled)return h("div",{class:L("loading")},[o.loading?o.loading():h(me,{class:L("loading-icon")},{default:()=>[e.loadingText||Te("loading")]})])};return j(()=>[e.loading,e.finished,e.error],f),a&&j(a,i=>{i&&f()}),oe(()=>{s.value=e.loading}),G(()=>{e.immediateCheck&&f()}),J({check:f}),ie("scroll",f,{target:_,passive:!0}),()=>{var i;const k=(i=o.default)==null?void 0:i.call(o),w=h("div",{ref:g,class:L("placeholder")},null);return h("div",{ref:r,role:"feed",class:L(),"aria-busy":s.value},[e.direction==="down"?k:w,E(),x(),N(),e.direction==="up"?k:w])}}});const be=X(ye),[we,Y]=D("text-ellipsis"),ke={rows:q(1),dots:S("..."),content:S(""),expandText:S(""),collapseText:S(""),position:S("end")};var pe=U({name:we,props:ke,emits:["clickAction"],setup(e,{emit:u,slots:o}){const s=d(e.content),r=d(!1),g=d(!1),a=d(),T=d();let _=!1;const f=K(()=>r.value?e.collapseText:e.expandText),x=t=>{if(!t)return 0;const n=t.match(/^\d*(\.\d*)?/);return n?Number(n[0]):0},M=()=>{if(!a.value||!a.value.isConnected)return;const t=window.getComputedStyle(a.value),n=document.createElement("div");return Array.prototype.slice.apply(t).forEach(p=>{n.style.setProperty(p,t.getPropertyValue(p))}),n.style.position="fixed",n.style.zIndex="-9999",n.style.top="-9999px",n.style.height="auto",n.style.minHeight="auto",n.style.maxHeight="auto",n.innerText=e.content,document.body.appendChild(n),n},N=(t,n)=>{var A,p;const{content:m,position:H,dots:B}=e,C=m.length,F=0+C>>1,V=o.action?(p=(A=T.value)==null?void 0:A.outerHTML)!=null?p:"":e.expandText,P=()=>{const l=(c,y)=>{if(y-c<=1)return H==="end"?m.slice(0,c)+B:B+m.slice(y,C);const v=Math.round((c+y)/2);return H==="end"?t.innerText=m.slice(0,v)+B:t.innerText=B+m.slice(v,C),t.innerHTML+=V,t.offsetHeight>n?H==="end"?l(c,v):l(v,y):H==="end"?l(v,y):l(c,v)};return l(0,C)},R=(l,c)=>{if(l[1]-l[0]<=1&&c[1]-c[0]<=1)return m.slice(0,l[0])+B+m.slice(c[1],C);const y=Math.floor((l[0]+l[1])/2),v=Math.ceil((c[0]+c[1])/2);return t.innerText=e.content.slice(0,y)+e.dots+e.content.slice(v,C),t.innerHTML+=V,t.offsetHeight>=n?R([l[0],y],[v,c[1]]):R([y,l[1]],[c[0],v])};return e.position==="middle"?R([0,F],[F,C]):P()},E=()=>{const t=M();if(!t){_=!0;return}const{paddingBottom:n,paddingTop:A,lineHeight:p}=t.style,m=Math.ceil((Number(e.rows)+.5)*x(p)+x(A)+x(n));m<t.offsetHeight?(g.value=!0,s.value=N(t,m)):(g.value=!1,s.value=e.content),document.body.removeChild(t)},i=(t=!r.value)=>{r.value=t},k=t=>{i(),u("clickAction",t)},w=()=>{const t=o.action?o.action({expanded:r.value}):f.value;return h("span",{ref:T,class:Y("action"),onClick:k},[t])};return G(()=>{E(),o.action&&Q(E)}),Z(()=>{_&&(_=!1,E())}),j([ae,()=>[e.content,e.rows,e.position]],E),J({toggle:i}),()=>h("div",{ref:a,class:Y()},[r.value?e.content:s.value,g.value?w():null])}});const Ce=X(pe),Ee={class:"space-y-10"},Le={class:"shrink-0"},Se={class:"rounded-full bg-gray-500/20 flex h-48 w-48 items-center justify-center overflow-hidden"},Ae={class:"text-[16px] text-zinc-600 tabular-nums dark:text-zinc-400"},Be={class:"flex-1 min-w-0"},He={class:"mb-2 flex flex-row gap-1 w-full justify-between"},Me={class:"text-[16px] text-zinc-600 tracking-tight font-semibold w-1/2 dark:text-white"},Ne={class:"text-[14px] text-zinc-500"},Re=U({name:"ScrollCache",__name:"index",setup(e){const u=d(!1),o=d(!1),s=d([]);function r(){setTimeout(()=>{for(let a=0;a<10;a++)s.value.push("".concat(s.value.length+1));u.value=!1,s.value.length>=40&&(o.value=!0)},1e3)}const g=d(0);return Z(()=>{window.scrollTo(0,g.value)}),le(()=>{g.value=window.scrollY||document.documentElement.scrollTop||document.body.scrollTop}),(a,T)=>{const _=Ce,f=be;return z(),ce(f,{loading:$(u),"onUpdate:loading":T[0]||(T[0]=x=>xe(u)?u.value=x:null),finished:$(o),"finished-text":"已经到底啦 ~","loading-text":"加载中...",onLoad:r},{default:de(()=>[b("ul",Ee,[(z(!0),O(re,null,ue($(s),x=>(z(),O("li",{key:x,class:"p-3 flex gap-12"},[b("div",Le,[b("div",Se,[b("span",Ae,fe(x),1)])]),b("div",Be,[b("div",He,[b("h3",Me,[h(_,{content:"段落标题"})]),T[1]||(T[1]=b("time",{class:"text-[12px] text-zinc-400 tabular-nums"},"2025-05-16",-1))]),b("p",Ne,[h(_,{rows:2,content:"段落内容段落内容段落内容段落内容段落内容段落内容"})])])]))),128))])]),_:1},8,["loading","finished"])}}});typeof W=="function"&&W(Re);export{Re as default};
