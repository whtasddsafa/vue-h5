import{aj as ee,d as F,L as te,_ as S,K as D,c as O,v as d,ak as ne,f as W,x as $,al as oe,y as G,a3 as J,ac as ie,b as h,T as Q,am as q,an as se,w as X,ao as Z,ap as le,aq as ae,q as ce,o as j,l as de,k as b,j as I,F as re,r as ue,p as z,C as fe,m as xe}from"./index-c8Fo5no0.js";import{L as me}from"./index-D5QMxqjy.js";import{b as K}from"./route-block-B_A1xBdJ.js";const ve=Symbol(),he=()=>ee(ve,null),[ge,L,Te]=O("list"),_e={error:Boolean,offset:D(300),loading:Boolean,disabled:Boolean,finished:Boolean,scroller:Object,errorText:String,direction:S("down"),loadingText:String,finishedText:String,immediateCheck:te};var ye=F({name:ge,props:_e,emits:["load","update:error","update:loading"],setup(e,{emit:u,slots:o}){const s=d(e.loading),r=d(),g=d(),l=he(),T=ne(r),_=W(()=>e.scroller||T.value),f=()=>{Q(()=>{if(s.value||e.finished||e.disabled||e.error||(l==null?void 0:l.value)===!1)return;const{direction:i}=e,k=+e.offset,w=q(_);if(!w.height||se(r))return;let t=!1;const n=q(g);i==="up"?t=w.top-n.top<=k:t=n.bottom-w.bottom<=k,t&&(s.value=!0,u("update:loading",!0),u("load"))})},x=()=>{if(e.finished){const i=o.finished?o.finished():e.finishedText;if(i)return h("div",{class:L("finished-text")},[i])}},M=()=>{u("update:error",!1),f()},N=()=>{if(e.error){const i=o.error?o.error():e.errorText;if(i)return h("div",{role:"button",class:L("error-text"),tabindex:0,onClick:M},[i])}},E=()=>{if(s.value&&!e.finished&&!e.disabled)return h("div",{class:L("loading")},[o.loading?o.loading():h(me,{class:L("loading-icon")},{default:()=>[e.loadingText||Te("loading")]})])};return $(()=>[e.loading,e.finished,e.error],f),l&&$(l,i=>{i&&f()}),oe(()=>{s.value=e.loading}),G(()=>{e.immediateCheck&&f()}),J({check:f}),ie("scroll",f,{target:_,passive:!0}),()=>{var i;const k=(i=o.default)==null?void 0:i.call(o),w=h("div",{ref:g,class:L("placeholder")},null);return h("div",{ref:r,role:"feed",class:L(),"aria-busy":s.value},[e.direction==="down"?k:w,E(),x(),N(),e.direction==="up"?k:w])}}});const be=X(ye),[we,Y]=O("text-ellipsis"),ke={rows:D(1),dots:S("..."),content:S(""),expandText:S(""),collapseText:S(""),position:S("end")};var pe=F({name:we,props:ke,emits:["clickAction"],setup(e,{emit:u,slots:o}){const s=d(e.content),r=d(!1),g=d(!1),l=d(),T=d();let _=!1;const f=W(()=>r.value?e.collapseText:e.expandText),x=t=>{if(!t)return 0;const n=t.match(/^\d*(\.\d*)?/);return n?Number(n[0]):0},M=()=>{if(!l.value||!l.value.isConnected)return;const t=window.getComputedStyle(l.value),n=document.createElement("div");return Array.prototype.slice.apply(t).forEach(p=>{n.style.setProperty(p,t.getPropertyValue(p))}),n.style.position="fixed",n.style.zIndex="-9999",n.style.top="-9999px",n.style.height="auto",n.style.minHeight="auto",n.style.maxHeight="auto",n.innerText=e.content,document.body.appendChild(n),n},N=(t,n)=>{var A,p;const{content:m,position:H,dots:B}=e,C=m.length,U=0+C>>1,V=o.action?(p=(A=T.value)==null?void 0:A.outerHTML)!=null?p:"":e.expandText,P=()=>{const a=(c,y)=>{if(y-c<=1)return H==="end"?m.slice(0,c)+B:B+m.slice(y,C);const v=Math.round((c+y)/2);return H==="end"?t.innerText=m.slice(0,v)+B:t.innerText=B+m.slice(v,C),t.innerHTML+=V,t.offsetHeight>n?H==="end"?a(c,v):a(v,y):H==="end"?a(v,y):a(c,v)};return a(0,C)},R=(a,c)=>{if(a[1]-a[0]<=1&&c[1]-c[0]<=1)return m.slice(0,a[0])+B+m.slice(c[1],C);const y=Math.floor((a[0]+a[1])/2),v=Math.ceil((c[0]+c[1])/2);return t.innerText=e.content.slice(0,y)+e.dots+e.content.slice(v,C),t.innerHTML+=V,t.offsetHeight>=n?R([a[0],y],[v,c[1]]):R([y,a[1]],[c[0],v])};return e.position==="middle"?R([0,U],[U,C]):P()},E=()=>{const t=M();if(!t){_=!0;return}const{paddingBottom:n,paddingTop:A,lineHeight:p}=t.style,m=Math.ceil((Number(e.rows)+.5)*x(p)+x(A)+x(n));m<t.offsetHeight?(g.value=!0,s.value=N(t,m)):(g.value=!1,s.value=e.content),document.body.removeChild(t)},i=(t=!r.value)=>{r.value=t},k=t=>{i(),u("clickAction",t)},w=()=>{const t=o.action?o.action({expanded:r.value}):f.value;return h("span",{ref:T,class:Y("action"),onClick:k},[t])};return G(()=>{E(),o.action&&Q(E)}),Z(()=>{_&&(_=!1,E())}),$([le,()=>[e.content,e.rows,e.position]],E),J({toggle:i}),()=>h("div",{ref:l,class:Y()},[r.value?e.content:s.value,g.value?w():null])}});const Ce=X(pe),Ee={class:"space-y-10"},Le={class:"shrink-0"},Se={class:"rounded-full bg-gray-500/20 flex h-48 w-48 items-center justify-center overflow-hidden"},Ae={class:"text-[16px] text-zinc-600 tabular-nums dark:text-zinc-400"},Be={class:"flex-1 min-w-0"},He={class:"mb-2 flex flex-row gap-1 w-full justify-between"},Me={class:"text-[16px] text-zinc-600 tracking-tight font-semibold w-1/2 dark:text-white"},Ne={class:"text-[14px] text-zinc-500"},Re=F({name:"ScrollCache",__name:"index",setup(e){const u=d(!1),o=d(!1),s=d([]);function r(){setTimeout(()=>{for(let l=0;l<10;l++)s.value.push("".concat(s.value.length+1));u.value=!1,s.value.length>=40&&(o.value=!0)},1e3)}const g=d(0);return Z(()=>{window.scrollTo(0,g.value)}),ae(()=>{g.value=window.scrollY||document.documentElement.scrollTop||document.body.scrollTop}),(l,T)=>{const _=Ce,f=be;return j(),ce(f,{loading:z(u),"onUpdate:loading":T[0]||(T[0]=x=>xe(u)?u.value=x:null),finished:z(o),"finished-text":"已经到底啦 ~","loading-text":"加载中...",onLoad:r},{default:de(()=>[b("ul",Ee,[(j(!0),I(re,null,ue(z(s),x=>(j(),I("li",{key:x,class:"p-3 flex gap-12"},[b("div",Le,[b("div",Se,[b("span",Ae,fe(x),1)])]),b("div",Be,[b("div",He,[b("h3",Me,[h(_,{content:"段落标题"})]),T[1]||(T[1]=b("time",{class:"text-[12px] text-zinc-400 tabular-nums"},"2025-05-16",-1))]),b("p",Ne,[h(_,{rows:2,content:"段落内容段落内容段落内容段落内容段落内容段落内容"})])])]))),128))])]),_:1},8,["loading","finished"])}}});typeof K=="function"&&K(Re);export{Re as default};
